rate_df.groupby('isbn').agg(count(col('rate')),count_distinct(col('rate'))).show(10, truncate = False)
+----------+-----------+--------------------+
|isbn      |count(rate)|count(DISTINCT rate)| rates_array
+----------+-----------+--------------------+
|0749317256|1          |1                   | [4]
|0671002481|90         |6                   | [6,5,4,3,3,3,4,3,3,2,2,2,2,2,2,]
|0380792206|2          |1                   | [7,7]
|0553581554|124        |9                   | [5,6,6,5,5,5,5,4,4,4,4,4,4,3,3,3,]
|1589636147|1          |1                   |
|0394580702|12         |5                   |
|1576903389|1          |1                   |
|0395816521|2          |1                   |
|8878197912|2          |1                   |
|2207303888|3          |1                   |
+----------+-----------+--------------------+


isbn, rates
0749317256, [4]
0671002481, [6,5,4,3,3,3,4,3,3,2]
0380792206, [7,7]
0553581554, [5,6,6,5,5,5,5,4,4,4,4,4,4,3,3,3,]
===================================================

output:
============
0749317256, 4
0671002481,6
0671002481,5
0671002481,4
0671002481,3
0671002481,3
0671002481,3
0671002481,4
0671002481,3
0671002481,3
0671002481,2
0380792206,7
0380792206,7













